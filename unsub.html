
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>CleverTap unsubscribe</title>
    <link href="./style.css" rel="stylesheet" type="text/css" />

    <style>
      .title {
        display: flex;
        border: none;
        margin: 10px auto;
        font-size: 24px;
        font-weight: 600;
        text-align: center;
      }
      .title:focus {
        outline: none;
      }
    </style>
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>

    <script type="text/javascript">
      var clevertap = {
        event: [],
        profile: [],
        account: [],
        onUserLogin: [],
        notifications: [],
      };

      clevertap.account.push({ id: "468-W87-546Z" });

      (function () {
        var wzrk = document.createElement("script");
        wzrk.type = "text/javascript";
        wzrk.async = true;
        wzrk.src = ('https:' == document.location.protocol ? 'https://d2r1yp2w7bby2u.cloudfront.net' : 'http://static.clevertap.com') + '/js/clevertap.min.js';
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(wzrk, s);
      })();
    </script>
  </head>
  <body>
    <script>
      setTimeout(function () {
        var ctid = clevertap.getCleverTapID();
        if (!ctid) {
          console.log("CT ID-" + clevertap.getCleverTapID());
          window.location.reload();
        } else {
          console.log("CT ID-" + clevertap.getCleverTapID());
        }
      }, 3000);
    </script>
    <div
      id="subscribeform"
      name="subscribeform"
      style="line-height: 26px; padding: 15px; text-align: center"
    >
      <div class="unsubscribeContent">

        <div class="mailSubscribe">
          <strong>
            <input
              class="title"
              type="text"
              id="email"
              readonly="readonly"
            /> </strong
          ><br />
          is subscribed to our mailing list(s).
        </div>
        <div class="subsInnerContent">
          <strong class="msgTitle">Unsubscribe from our mailing list</strong
          ><br />
          To help us improve our services, we would be grateful if you could
          tell us why:<br />
          <div class="selectReason" style="margin-top: 35px; min-width: 250px">
            <select
              class="inputType"
              id="selectUnsubscribeReason"
              name="unsubscribereason"
              onchange="reasonHandler()"
            >
              <option value="">Please select reason</option>
              <option value="Your emails are not relevant to me">
                Your emails are not relevant to me
              </option>
              <option value="Your emails are too frequent">
                Your emails are too frequent
              </option>
              <option value="I don't remember signing up for this">
                I don't remember signing up for this
              </option>
              <option value="I no longer want to receive these emails">
                I no longer want to receive these emails
              </option>
              <option value="The emails are spam and should be reported">
                The emails are spam and should be reported
              </option>
              <option value="others">Others</option></select
            ><br />
            <textarea
              style="display: none; margin-top: 22px"
              id="unsubscribereason"
              name="unsubscribereason_others"
              class="hideTextarea inputType"
              rows="4"
              onchange="OtherReason()"
              placeholder="Provide your reason here..."
            ></textarea>
            <span style="display: none" class="errorMsg"
              >Please Enter Reason</span
            >
          </div>
        </div>
        <br /><br />
        <div style="text-align: center">
          <button
            class="primaryBtn"
            name="unsubscribe"
            value="Unsubscribe"
            type="submit"
            onclick="unsubscribe()"
          >
            Submit
          </button>
        </div>
      </div>
    </div>


  <script>
    var isReEncode = false;
    var statusLabel = "";
    var reasonValue = "";
    var userEmail = "";

    window.onload = function () {
      $WZRK_WR.getEmail(isReEncode);
    };

    function wzrk_email_fetched(emailStr) {
      userEmail = emailStr;
      document.getElementById("email").value = emailStr;
      console.log("Email is", emailStr);
      clevertap.onUserLogin.push({
        Site: {
          Email: emailStr,
        },
      });
    }

    function wzrk_email_subscription(status) {
      if (status == 0) {
        statusLabel = "You've been  Successfully unsubscribed";
      }
      document.querySelector(".primaryBtn").innerHTML =
        "Successfully unsubscribed";
    }

    function reasonHandler() {
      reasonValue = document.getElementById("selectUnsubscribeReason").value;
    }
    function OtherReason() {
      reasonValue = document.getElementById("unsubscribereason").value;
    }

    function unsubscribe(isReEncode) {
      if (reasonValue == "") {
        return (document.querySelector(".errorMsg").style.display = "block");
      }

      clevertap.event.push("Email_Unsubscribed", {
        Email: userEmail,
        reason: reasonValue,
      });

      $WZRK_WR.unSubEmail(isReEncode);
    }

    function resubscribe(isReEncode) {
      $WZRK_WR.subEmail(isReEncode);
    }
  </script>

  <script type="text/javascript">
    $("document").ready(function () {
      $("#selectUnsubscribeReason").change(function () {
        if ($(this).val() == "others") {
          $("#unsubscribereason").val("").fadeIn();
        } else {
          $("#unsubscribereason").val("").fadeOut();
        }
        $(".errorMsg").hide();
      });
      $("#unsubscribereason").keypress(function () {
        if ($(this).val() != "") {
          $(".errorMsg").hide();
        }
      });
    });
  </script>
    </body>
</html>
